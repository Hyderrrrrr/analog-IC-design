反馈与稳定性（二）
去年我们说到反馈的一些特性。现在说说稳定性。
稳定性在实践中其实是和反馈密不可分的。一个开环使用的东西，讨论稳定性是没有意义的。所以不需要讨论什么比较器的稳定性问题。从信号与系统的角度说，稳定性就是问：“当一个开环系统变成闭环后，它的极点位于哪里，是左平面还是右平面（或者虚轴）？”。在这个问题上，我觉得模电的很多书讲的都有些含糊，有时试图用直观去代替严格的理论，但是不幸的是很多时候造成的麻烦比好处更多。
先解答第一个问题，为什么本来要研究闭环系统特性，却偏偏要在开环的传输函数中讨论？一个可能的原因是简单有效。因为人们通过这个途径找到了简便的判断依据。如果直接讨论闭环，不是不行，信号与系统书上给了判决方法，但这种方法只能判断一个严格给出闭环传输函数的系统是否稳定，却说不出如果系数有微小变化时会怎样，所以在实电路设计实践中几乎不可用。而pll的设计书籍中很多直接在闭环函数中讨论系统的稳定性。有的opa的设计，也是直接在闭合函数中讨论。在这些方法中，大多是把系统拆成了二阶多项式的乘积，然后讨论Q。通过Q讨论稳定，或者瞬态特性。但这种方法毕竟不能对高阶的传输函数起作用。所以实际设计中，更多的还是直接在开环传输函数中讨论，因为我们有奈奎斯特判据。
奈奎斯特判据的含义大家可以找找资料。其实就是在画开环函数的图形，然后数包围（-1，0）的圈数。从wiki中得知，奈奎斯特判据的数学基础是复变函数，就等于将开环传输函数与闭环极点数目关联了起来。从理论上来说，这是最重要的判断依据。在此基础上，才有了个phase margin 和gain margin的概念。但是我觉得所有的模电课都应该在一开始就强调pm和gm的不完备性，换句话说，这两个东西并不是一定有效。但是现实中把这两个判据当成稳定的充分且必要判据的人比比皆是。所以误区1就是：pm没问题，就一定是稳定的。误区2就是pm，gm有问题，系统就不稳定了。（这里还只是讨论理论上的东西，还不涉及AC和tran的区别）
模电书上讲的很多的一个例子就是一个频率为f的sin波，绕环路一圈，到达相加节点后相位变为了-180度，然后说正反馈了，不稳定了。特别是在设计振荡器时，又有一个巴特豪斯判据，更加强化了这个概念。然而众多的基础问题就出在这里。是不是当增益大于1，相位低于-180，系统就不稳定了？这又如何解释pll的起始相位是-180？如果当增益未下降到0db时，相位低于-180之后又升了起来，是不是就不稳定了？我想模拟书上给大家个了一个直观的感受，却带来了一系列的问题。这有些像高中物理课本，没有强调惯性系和非惯性系，当年也给我造成了很大的困惑。
对于上面的一些问题，说说我自己的一些理解和结论。首先要推翻的一个结论就是当增益大于1，相位低于-180时，就会震荡。因为根据奈奎斯特定律，只有包围了-1，才会震荡，因此完全可以构造出满足前面条件的不震荡系统。同样的，对于pll，也不应该说什么震荡的问题（pll的曲线在dc点的增益裕度严重不对）。
解释了一个问题，会带来更多的问题。可能有人马上会问，那么巴特豪斯判据呢？这是good question。我想巴特豪斯的严格版本应该是增益为1，相位为-180.这是我们不用太多数学，马上可以算出，闭环系统有极点在虚轴上，这必然是等幅震荡。而巴特豪斯的工程版本则要求增益大于1，我们要注意到此时系统已经变成实际系统了，必须有一定的非线性使得等效增益降到1，才能真正震荡起来。
在另一个角度上看，系统振荡与否，取决于闭环的极点是否在右平面或者虚轴。而bode图实际是开环系统传输函数在虚轴上的取值。所以仅当增益为1，相位-180时，可以很容易的推导出闭环的极点在虚轴上，其他的都没法直接推导出右平面的极点。
说了这么多，是不是就否认了bode图中pm和gm的意义呢？没有！。对于我们大多数常见的系统，这两个还是很有效的。而且稳定不代表不震荡，pm和gm同时还给了时域上衰减震荡的趋势。只是当我们平时遇到一些特殊系统时，碰到用pm和gm解释不了的问题时，就应该反过头来仔细想想，这两个数值背后的条件是什么。
另外，我们还必须把理想系统ac分析和实际系统的tran分析区分开。ac分析得到的bode图一般只是一个稳定的必要条件而不是充分条件，tran一般才是最后的真正判据。
再就是当tran分析没问题时，ac如果有问题，是否可以否认ac的结论？我想保险起见，一定不要轻易否认。在实践中我碰到过tran激励加的不对的，也碰到过ac信号加的不对的，甚至碰到过仿真工具莫名其妙不对的，即使前面说的都仔细检查过了，设计者也不要轻易说，一定没问题。
 

