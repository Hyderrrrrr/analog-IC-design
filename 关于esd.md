ESD设计
ic里的esd设计算是一个偏门。在学校里很少有课程讲这方面内容。在公司里又很少有专人研究这个。所以esd相关的内容，一般都扔给analog design，layout，或者foundry。大家解决问题的办法也多数是连猜带蒙，有时候讨论起来也发现大家各自有各自的一套理论，有点鸡同鸭讲的感觉，那观点差异就大了（为什么呢？）。不像模拟电路设计，好歹一说稳定性，那就看看bode图吧。我这里的内容，也主要来自看的一些书籍（看书的理解不同，观点就不同），看的一些相关讨论及文档（看讨论也是各取所需，只看符合自己胃口的解释。看文档，我挺喜欢看foundry的文档，虽然不讲原理，但比较实用，如果能根据要求去反推原理，就感觉比单纯看书效果大），以及一些实验结果的理解（那就更是个人有个人的理解了）。所以大家也是各取所需，批判着看吧，有能提出自己论点和论据的更好。另外需要强调一点，esd是与工艺密切相关的，所以在有些工艺上成立的结论在另一个工艺上就不能那么绝对的接受，这是我个人的理解，但是我认为这个理解是没什么疑问的。
先从总体上说，esd我个人感觉应该包括esd器件设计，esd整体框架设计，内部电路针对esd的设计。
在最前面，其实应该提一下esd测试，包括hbm，mm，cdm等不同测试方法。所谓的hbm 2000v，很多人容易理解成内部电路要抗2000v电压，其实这个测试电路更像是一个电流源，如果芯片内部不能及时把1.33A电流（2000V/1500ohm)泄放，电压才会升上去，造成失效。
先说esd器件设计，这个似乎是很多书的重点内容，无非就是用diode，bip，scr去保护内部电路，这些器件的特性如何。对于diode，没什么好说的，无非一个正向导通，一个反向击穿，不过是利用正向导通还是反向击穿呢？我个人理解大多数是用正向导通特性，因为反向击穿电压似乎还是有些高。
对于bip（ggnmos，gcnmos等也是利用寄生bip），scr这种，属于有snapback特性的器件，参数就包括trig电压，hold电压，二次击穿电流（有的书上是vt1，vt2等）。按照大多数的书说法，trig电压的设计是保护并联器件不被击穿，hold电压是保证正常工作不发生latchup，二次击穿电流反映了承受电流能力的极限。不过一般电路设计者哪里有条件去测试这些呢？多数情况下还是希望知道一个定性的与layout的关系。可是似乎albert wang等人的书上就是对此不提。
我个人理解，trig其实就是bip的击穿电压（与掺杂浓度相关），它应该介于cb0和ce0之间，因为基区电阻大小是介于0和无穷大之间的。esd的版图里就有一项是考虑衬底接触的画法。我自己理解凡是方便esd的画法都是容易latchup的画法。比如esd cell的衬底接触就不要求多（似乎有design rule里特别强调了。但是我印象中若干年前的工艺里又是另一种要求，是工艺变化造成rul的改变，还是知识发展了，认为以前的做法不好，这是个疑问。为了这个blog，专门查了一下资料。我手上某年ker的一个ppt里提到，在0.35um工艺下给esd mos每个finger间都插入接地ptap，保证寄生bjt的基区电阻一致，从而开启一致。但我手上foundry的design rule里都明确禁止了这种做法。）。除此之外，gate电压也是一个控制参数，gcnmos就是利用这个原理去控制cell的开启。还有其他的一些做法，比如scr里给衬底注入等，不设计esd cell，我也就没关心那些奇怪的做法。这里顺带提一下，pmos似乎比较特殊，一般讨论esd都是讨论nmos，pmos似乎snapback特性不明显，抗esd能力很强（为什么呢？有人说是空穴迁移率低，有人说是beta值低，但这前后的逻辑关系是什么呢？），给人的感觉是不用怎么特意保护。
另一项hold电压我就不是太清楚如何控制了，从电学上就是饱和压降和ir drop。但是这个电压也很关键，要避免esd电路变成latchup电路，就全靠这个参数控制。而二次击穿电流应该就基本上直接与esd等级成正比了。二次击穿应该与有效的w/l有关，所以给drain加入镇流电阻是最简单有效的方法，或者就是把drain端距离拉大一些（更多时候需要加sab，阻挡其成为低阻）。这个办法几乎成了esd的代名词，很多时候电路里标follow esd rule，其实就只做了这一个工作。加了镇流电阻，就是希望各个finger之间均匀导通，最差情况也是一个finger在二次击穿之前就能达到trig电压，从而开启其他finger（这个镇流电阻按某文献说法，还有另一个作用就是强迫电流从衬底流动。衬底通路是寄生bjt，在esd时导通能力要强）。所以这里其实还有另一个esd rule，就是每个finger不能太长或者太短。但是加在source端行吗？至少很多实验结论是不行。foundry还提供esd注入一个选项。按一些文献的说法，这是为了降低esd mos的trig电压。但是工艺厂家不同，这个步骤的方法和目的是否一定相同？在不知道每个工艺厂家具体情况之前就轻易下结论是不可信的。就我看到的文档，是没有提这个步骤的详细过程，只是告诉用户，如果加了这层，可能会提高esd能力。
（未完待续）
 

