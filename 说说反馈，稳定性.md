反馈与稳定性（一）
反馈，在生活中无处不在。在电路里就更不用说了。没有了反馈，我们分析电路就容易的多了，可是我们能实现的也就少的很了。
反馈我觉得是学习模电中最重要的一个概念。一般我拿到手一个系统，或者电路，首先干的事情就是看看里面的信号反馈通路，如果能把它清晰的分解出来，那么对这个系统的理解就可以完成百分之七八十了。
要讨论反馈，也得先给他分分类。（说句题外话，分类的好处远大于我们一般的理解。）反馈本身有正负之分。正反馈一般讨论的比较少，但是正反馈也有一些明显的用途。负反馈是最常见的，也是讨论最详细的。下面我也根据实际中碰到的一些情况来讨论一下。而稳定性就像是负反馈的子女，与负反馈形影不离，所以也会在下面讨论一下。
先说说正反馈。正反馈的用途挺多。根据环路增益来说，如果大于1，就不稳定，形成latch。latch大家应该都用过。如果没有用过latch，那正反馈型的比较器呢？正反馈型的比较器有个特定，增益无穷大，所以只要给足够的时间就可以达到无限的精度，另一方面，它的输出是指数形式的，结合preamp，可以得到高速的比较器。这个是不是也不错？在比较器设计中碰到的迟滞也是由正反馈引起的，所以一般来说有迟滞就可以看到正反馈。如果环路增益小于1，那就是一个稳定的系统，我们之前在bandgap的设计中也见到过这种形式。除此之外，根据A/(1+A*beta)，还可以得出结论，当A*beta大于-1（此时A为负值）时，增益可以提高，这个在某些时候也会用到。
{对于正反馈，有个问题就是A/(1+A*beta)这个公式是否成立。因为对于环路增益大于1的正反馈，明显是无穷大输出，但根据公式却会得到一个常数。我的理解是如果用无穷级数求和方法去推导公式，那么这个级数是发散的，而我们却偷偷用了能收敛的条件。这种理解方式也许能说服一些人，不过我觉得还是有些不严格，因为实际上无穷求和只是我们对负反馈形象的一种理解。（在这个地方我又想了一下，觉得前面的理解应该是有问题的。首先，在理论上，如果增益为恒大于1，相位不变，是否一定会输出无穷大，存疑，我认为不是。其次，当环路引入延迟，那么就是之前说的那种级数发散，但是相应的公式中也不能用常数，带入实际环路T之后用公式仍然是成立的。再者，到底在DC相位如何会导致正反馈，我认为其实但看DC一点是不够的，需要看DC的邻域。这个问题在pll的理论中我一直没想通，现在看来是可以说服自己了。）}
对于上面一段，时隔一年，自己又有了新的体会，在概念上修正了自己的一些理解，同时对于一些传统的观点也有了自己的认识，觉得值得在这里写出来告诉大家。之前对正反馈的理解，一个疑问就是A/(1+A*beta)是否成立？因为假设A为常数，会得到一个固定的值，这与正反馈不稳定的概念格格不入。我不知道其他人是否专门为这个问题仿真看看，至少我前两天为此专门做行为级仿真看了看，结论是这个公式成立。如果这个公式成立，那新的问题就是系统难道是稳定的？我的结论是：稳定！有人会说，你这不是公开与教科书为敌吗？我们不是一直学的都是正反馈增益大于1则不稳定，只有小于1才稳定。我从毕业这么多年，也是一直这样理解的，但是总有几个问题绕不过去，一个就是刚才说的，那个A/(1+A*beta)是否成立，从这个公式里如何理解稳定性，另一个就是前一段自己给自己提出的问题：如何将稳定性与那个无穷级数求和的解释统一起来，以及如何解释pll的初始相位。刚才解答了第一个 问题，那接着就得说，用无穷级数求和解释稳定性，属于用一个不严格的形象式回答错误的解释了一个严格的数学问题。换句话说，无穷级数的回答，是错误的，它与正反馈的稳定性有一定的关系，但严格来说，是偷换了概念。一个正反馈即使增益大于1，也是可以稳定的。第三个pll的问题，如果沿着正确的理论走，那就是显而易见的了。
在这里，就将这个问题背后的理论理顺归纳一下。首先，A/(1+A*beta)是从数学公式推导出来的，在正反馈时，前提没变，形式没变，因此这个公式依然成立，如果搭一个行为级电路，放大器有一个固定的增益，他的确可以稳定在这个公式的计算结果上。所以用等比数列求和去解释稳定性，就错了。正反馈的稳定性仍然可以用最基本的理论去推导，那就是闭环传输函数中不能有右极点。根据这个，可以进一步推论，如果这个放大器有一个极点，那必然不稳定。形象的想，放大器的输出总有那么一点延迟，那就不稳定了，但没了这个延迟，就是稳定的。所以用等比数列解释，其实隐含着每次求和总是有延迟的这个前提。这个解释固然能说明很多实际情况，但在基本概念上却是错的。对pll的问题，那显然了，虽然dc时貌似是正反馈，但那又如何？谁规定了这样不行呢？
在实践中，不可能存在没有一点延迟的正反馈，因此如果我们看实践中的电路，正反馈的稳定性基本可以由增益大小去判断。但是这也不意味着我们就可以这样去理解正反馈的稳定性问题。现在新的问题就是正反馈除了像pll那样在dc两个极点，可以通过一个零点调整成稳定的，其他类型的都无法调整成稳定的吗？算下来似乎得正极点才可以，但是电路中如何能实现呢？另一个问题就是乃奎斯特判据在这里如何应用呢？
对于负反馈，搞电路的人为了对付它，搞出了很多方法。最基本的一种就是把电路系统分成了A和beta。我个人理解这种做法只不过是由于以前分立opa设计中使用方便，从问题的本质上说，单稳定性而言是不应该区分A和beta的。我平时会关注更详细的几个要素：基准（一般就是输入，也是需要达到的目标），误差产生（就是框图中的求和单元），放大与执行（就是把A，beta和在一起看）。一般对于系统，找到这三个模块就等于找到了一个反馈回路。
虽然系统框图分析起来很简单，但在实际电路中就没有这么容易了，因为实际电路前后级会互相影响。根据电路的特点，人们又根据输入输出的情况把反馈分成了四大类。假如把运放当成理想的，那这四大类基本就可以用于分析了。可是有时这么分析还不够严格，所以在这四大类的基础上又进行了修正，让负载效应也正式被计算在内。可是这也不是最终的结果，因为除了负载效应，这个模型中忽略了一些网络的前向增益和后向增益。要是前向和后向增益也加进去，那么我们一定能得到最可靠的结果，不过这时候也和直接求解没什么区别了。所以，反馈的模型实际是对最精确模型进行一定的修剪，在精确度和简便性上做出的最好的tradeoff。
除了这四大类模型，gray书上还给了另一种反馈分析的模型return ratio。不过这和工具一样，很多时候用哪种不但看哪种好用，还要看哪种用的熟练。（我回去后又仔细看了这部分内容，看起来方法也很简单）
刚刚在论坛上看到一个之前的讨论，问某个电路是四种反馈中的哪种。我觉得想法很好，但是问的方式有待商榷。随便拿出来一个带反馈的电路，如果不说明输入输出，其实无所谓四种反馈中的哪种，因为同一个电路从不同的角度去看，可以得到不同的结论。因此我有一个进一步的推断：虽然从不同角度去看，反馈种类可以不同，但环路增益A*beta=T却应该是不变的，换句话说，T是一个更为恒定的量。这个推断我没有办法证明（呵呵，一翻书，我才想起来其实n年前我给其他人定性的证明过，用的就是信号与系统里的内容，只是自己记不住了），但是验证了一些结构，说明还是不错的，所以如果不是为了输入输出的一些特性，没有必要硬套四种反馈模型。另外，在稳定性的考虑中，也是T起决定性作用，而不是A。
（未完待续）
 

